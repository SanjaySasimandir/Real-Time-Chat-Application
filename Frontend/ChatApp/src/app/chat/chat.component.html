<div class="container-fluid outside-container">
    <nav class="navbar navbar-expand-md navbar-dark bg-light">
        <div class="container-fluid">
            <button mat-fab color="primary" (click)="drawer.toggle()">
                <!-- <mat-icon> format_list_bulleted</mat-icon> -->
                <!-- <mat-icon>vertical_split</mat-icon> -->
                <mat-icon>chrome_reader_mode</mat-icon>
            </button>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavAltMarkup"
                aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse justify-content-end" id="navbarNavAltMarkup">
                <div class="navbar-nav">
                    <a class="nav-link" aria-current="page" href="#">Home</a>
                    <a class="nav-link logoutButton" *ngIf="userAuth.loginStatus()" (click)="logout()">Logout</a>
                </div>
            </div>
        </div>
    </nav>
    <div class="container-fluid chat-container align-items-center">
        <mat-drawer-container>
            <mat-drawer class="my-auto col-12 col-sm-12 col-md-4 col-lg-4" #drawer mode="side" opened>
                <mat-tab-group mat-stretch-tabs class="mat-elevation-z4">
                    <mat-tab label="Chats">
                        <ng-template matTabContent>



                            <form (ngSubmit)="searchUser()">
                                <mat-form-field class="col-12" appearance="fill">
                                    <mat-label>Search users</mat-label>
                                    <input matInput [formControl]="searchItem" placeholder="johndoe12"
                                        (input)="searchUser()" maxlength="20">
                                    <button mat-icon-button matSuffix *ngIf="this.searchItem.value"
                                        (click)="this.searchItem.setValue('')" type="button">
                                        <mat-icon>close</mat-icon>
                                    </button>
                                    <button mat-icon-button matSuffix
                                        [type]="this.searchItem.value ? 'submit': 'button'">
                                        <mat-icon>search</mat-icon>
                                    </button>
                                </mat-form-field>
                            </form>

                            <!-- <a routerLink="/chat/{{searchResult.username}}" *ngIf="searchResult.username"> -->
                            <mat-card class="col-12 user-card" (click)="reroute(searchResult.username)"
                                *ngIf="searchResult.username">
                                <mat-card-header>
                                    <div mat-card-avatar class="card-avatar"
                                        style="background-image: url('https://material.angular.io/assets/img/examples/shiba1.jpg')">
                                    </div>
                                    <mat-card-title class="text-truncate">{{searchResult.firstName}}
                                        {{searchResult.lastName}}
                                    </mat-card-title>
                                    <mat-card-subtitle class="text-truncate">@{{searchResult.username}}
                                    </mat-card-subtitle>
                                </mat-card-header>
                            </mat-card>
                            <!-- </a> -->

                            <mat-card class="col-12"
                                *ngIf="searchLoadingEnable && searchResult.username=='' && searchItem.value">
                                <mat-card-header>
                                    <mat-card-title>Loading...</mat-card-title>
                                </mat-card-header>
                            </mat-card>

                            <mat-card class="col-12"
                                *ngIf="!searchResult.username && searchItem.value && searchLoadingEnable==false">
                                <mat-card-header>
                                    <mat-card-title>No users found</mat-card-title>
                                </mat-card-header>
                            </mat-card>
                            <mat-divider></mat-divider>

                            <div class="hover-background-change d-sm-none d-md-block" *ngFor="let contact of contacts"
                                (click)="selectContact(contact)">
                                <mat-card class="col-12 d-flex align-items-center user-card"
                                    [class]="selectedContact==contact? 'selected-contact':''">
                                    <div class="flex-grow-1 row align-items-center">
                                        <div mat-card-avatar class="col-2 card-avatar"
                                            style="background-image: url('https://material.angular.io/assets/img/examples/shiba1.jpg')">
                                        </div>
                                        <div class="col-8">
                                            <mat-card-title class="text-truncate">{{contact.firstName}}
                                                {{contact.lastName}}</mat-card-title>
                                            <mat-card-subtitle class="text-truncate">{{contact.username}}
                                            </mat-card-subtitle>
                                        </div>
                                    </div>
                                    <div class="col-1 mute-block d-flex justify-content-center align-items-center">
                                        <mat-icon *ngIf="mutedContacts.includes(contact.username)">volume_off</mat-icon>
                                        <mat-icon *ngIf="blockedContacts.includes(contact.username)">block</mat-icon>
                                    </div>
                                </mat-card>
                            </div>

                            <div class="hover-background-change d-none d-sm-block d-md-none"
                                *ngFor="let contact of contacts" (click)="selectContact(contact);drawer.close();">
                                <mat-card class="col-12 d-flex align-items-center user-card"
                                    [class]="selectedContact==contact? 'selected-contact':''">
                                    <div class="flex-grow-1 row align-items-center">
                                        <div mat-card-avatar class="col-2 card-avatar"
                                            style="background-image: url('https://material.angular.io/assets/img/examples/shiba1.jpg')">
                                        </div>
                                        <div class="col-8">
                                            <mat-card-title class="text-truncate">{{contact.firstName}}
                                                {{contact.lastName}}</mat-card-title>
                                            <mat-card-subtitle class="text-truncate">{{contact.username}}
                                            </mat-card-subtitle>
                                        </div>
                                    </div>
                                    <div class="col-1 mute-block d-flex justify-content-center align-items-center">
                                        <mat-icon *ngIf="mutedContacts.includes(contact.username)">volume_off</mat-icon>
                                        <mat-icon *ngIf="blockedContacts.includes(contact.username)">block</mat-icon>
                                    </div>
                                </mat-card>
                            </div>
                        </ng-template>
                    </mat-tab>
                    <mat-tab label="Online">
                        <ng-template matTabContent>
                            <div class="hover-background-change" *ngFor="let contact of onlineContacts"
                                (click)="selectContact(contact)">
                                <mat-card class="col-12 d-flex align-items-center user-card"
                                    [class]="selectedContact==contact? 'selected-contact':''">
                                    <div class="flex-grow-1 row align-items-center">
                                        <div mat-card-avatar class="col-2 card-avatar"
                                            style="background-image: url('https://material.angular.io/assets/img/examples/shiba1.jpg')">
                                        </div>
                                        <div class="col-8">
                                            <mat-card-title class="text-truncate">{{contact.firstName}}
                                                {{contact.lastName}}</mat-card-title>
                                            <mat-card-subtitle class="text-truncate">{{contact.username}}
                                            </mat-card-subtitle>
                                        </div>
                                    </div>
                                    <div class="col-1 mute-block d-flex justify-content-center align-items-center">
                                        <mat-icon *ngIf="mutedContacts.includes(contact.username)">volume_off</mat-icon>
                                        <mat-icon *ngIf="blockedContacts.includes(contact.username)">block</mat-icon>
                                    </div>
                                </mat-card>
                            </div>
                        </ng-template>
                    </mat-tab>
                </mat-tab-group>

            </mat-drawer>
            <mat-drawer-content
                class="col-12 col-sm-12 col-md-8 col-lg-8 d-inline-flex justify-content-center align-items-center">
                <button mat-fab class="toggle-negative" color="primary" (click)="drawer.toggle()">
                    <mat-icon>&nbsp;&nbsp;{{drawer.opened? ' arrow_back_ios' : 'arrow_forward_ios'}}</mat-icon>
                </button>
                <app-select-chat class="flex-grow-1" *ngIf="!selectedContact.username"></app-select-chat>
                <app-chatbox class="flex-grow-1" *ngIf="selectedContact.username" (contactsrefresh)="loadContacts()"
                    [contact]="selectedContact"></app-chatbox>
            </mat-drawer-content>
        </mat-drawer-container>
    </div>
</div>